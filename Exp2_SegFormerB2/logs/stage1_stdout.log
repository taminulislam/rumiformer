/home/siu856569517/Taminul/co2_farm/src/train/train_segmentation.py:239: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
============================================================
  RumiFormer — Stage 1: Segmentation Pretraining
============================================================
  project_root: /home/siu856569517/Taminul/co2_farm
  annotations_csv: /home/siu856569517/Taminul/co2_farm/annotations/annotations.csv
  clips_csv: /home/siu856569517/Taminul/co2_farm/annotations/clips.csv
  checkpoint_dir: /home/siu856569517/Taminul/co2_farm/Exp2_SegFormerB2/checkpoints
  log_dir: /home/siu856569517/Taminul/co2_farm/Exp2_SegFormerB2/logs
  seed: 42
  precision: bf16
  num_workers: 8
  pin_memory: True
  use_compile: True
  gradient_checkpointing: False
  optimizer: adamw
  weight_decay: 0.01
  resume_from: None
  save_every_n_epochs: 1
  save_every_n_steps: None
  keep_last_n_checkpoints: 3
  use_wandb: False
  wandb_project: rumiformer
  wandb_run_name: None
  log_every_n_steps: 10
  show_eta: True
  stage_name: segmentation
  substage_1a_epochs: 8
  substage_1a_lr: 6e-05
  substage_1b_epochs: 12
  substage_1b_lr: 1e-05
  img_size: (256, 320)
  batch_size: 32
  bce_weight: 0.5
  dice_weight: 0.5
  scheduler: cosine
  warmup_steps: 500
  decode_dim: 256
  use_aux_mask: True
============================================================
World size: 1 GPUs
Train: 4157 frames, Val: 1059 frames
Model: segformer_b2 (24.7M params)

--- Sub-stage 1a: Freeze backbone ---
Trainable: 528,385 / 24,724,673 params
/home/siu856569517/Taminul/co2_farm/src/train/train_segmentation.py:119: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(dtype=torch.bfloat16):
  [E00 S00010] loss=0.7471 bce=0.6688 dice=0.8255 lr=1.20e-06 ETA=23m 07s elapsed=0m 13s
  [E00 S00020] loss=0.7445 bce=0.6414 dice=0.8475 lr=2.40e-06 ETA=20m 17s elapsed=0m 24s
  [E00 S00030] loss=0.7250 bce=0.6409 dice=0.8092 lr=3.60e-06 ETA=19m 14s elapsed=0m 34s
  [E00 S00040] loss=0.7146 bce=0.6237 dice=0.8055 lr=4.80e-06 ETA=18m 38s elapsed=0m 45s
  [E00 S00050] loss=0.7185 bce=0.6235 dice=0.8134 lr=6.00e-06 ETA=18m 13s elapsed=0m 55s
  [E00 S00060] loss=0.7390 bce=0.6187 dice=0.8593 lr=7.20e-06 ETA=17m 52s elapsed=1m 06s
  [E00 S00070] loss=0.7012 bce=0.5968 dice=0.8057 lr=8.40e-06 ETA=17m 34s elapsed=1m 16s
  [E00 S00080] loss=0.6799 bce=0.5767 dice=0.7831 lr=9.60e-06 ETA=17m 19s elapsed=1m 27s
  [E00 S00090] loss=0.6989 bce=0.5740 dice=0.8238 lr=1.08e-05 ETA=17m 04s elapsed=1m 37s
  [E00 S00100] loss=0.6666 bce=0.5569 dice=0.7763 lr=1.20e-05 ETA=16m 50s elapsed=1m 48s
  [E00 S00110] loss=0.6464 bce=0.5396 dice=0.7531 lr=1.32e-05 ETA=16m 37s elapsed=1m 59s
  [E00 S00120] loss=0.6289 bce=0.5273 dice=0.7306 lr=1.44e-05 ETA=16m 25s elapsed=2m 09s
/home/siu856569517/Taminul/co2_farm/src/train/train_segmentation.py:161: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(dtype=torch.bfloat16):
  [Epoch 00] train_loss=0.7014 val_loss=0.6724 mIoU=0.3666 Dice=0.5208 P=0.3712 R=0.9814 BF1=0.0131 HD=175.0px CE=32.7px
  ★ New best mIoU=0.3666
[Checkpoint] Saved: segmentation_1a_epoch0000_step000129.pt
  [E01 S00130] loss=0.6399 bce=0.5224 dice=0.7574 lr=1.56e-05 ETA=22m 39s elapsed=3m 15s
  [E01 S00140] loss=0.6139 bce=0.5012 dice=0.7265 lr=1.68e-05 ETA=21m 56s elapsed=3m 26s
  [E01 S00150] loss=0.5951 bce=0.4877 dice=0.7025 lr=1.80e-05 ETA=21m 17s elapsed=3m 37s
  [E01 S00160] loss=0.5822 bce=0.4697 dice=0.6946 lr=1.92e-05 ETA=20m 41s elapsed=3m 47s
  [E01 S00170] loss=0.5959 bce=0.4730 dice=0.7187 lr=2.04e-05 ETA=20m 08s elapsed=3m 58s
  [E01 S00180] loss=0.5819 bce=0.4498 dice=0.7140 lr=2.16e-05 ETA=19m 38s elapsed=4m 09s
  [E01 S00190] loss=0.5270 bce=0.4119 dice=0.6421 lr=2.28e-05 ETA=19m 10s elapsed=4m 19s
  [E01 S00200] loss=0.5746 bce=0.4361 dice=0.7132 lr=2.40e-05 ETA=18m 44s elapsed=4m 30s
  [E01 S00210] loss=0.5561 bce=0.4197 dice=0.6924 lr=2.52e-05 ETA=18m 19s elapsed=4m 40s
  [E01 S00220] loss=0.5286 bce=0.3955 dice=0.6617 lr=2.64e-05 ETA=17m 56s elapsed=4m 51s
  [E01 S00230] loss=0.5314 bce=0.3854 dice=0.6774 lr=2.76e-05 ETA=17m 33s elapsed=5m 02s
  [E01 S00240] loss=0.5171 bce=0.3796 dice=0.6547 lr=2.88e-05 ETA=17m 12s elapsed=5m 12s
  [E01 S00250] loss=0.4694 bce=0.3486 dice=0.5902 lr=3.00e-05 ETA=16m 51s elapsed=5m 23s
  [Epoch 01] train_loss=0.5580 val_loss=0.5400 mIoU=0.5791 Dice=0.7197 P=0.5845 R=0.9874 BF1=0.0339 HD=149.0px CE=18.3px
  ★ New best mIoU=0.5791
[Checkpoint] Saved: segmentation_1a_epoch0001_step000258.pt
  [E02 S00260] loss=0.4855 bce=0.3493 dice=0.6217 lr=3.12e-05 ETA=18m 37s elapsed=6m 16s
  [E02 S00270] loss=0.4349 bce=0.3084 dice=0.5614 lr=3.24e-05 ETA=18m 12s elapsed=6m 27s
  [E02 S00280] loss=0.4169 bce=0.2874 dice=0.5463 lr=3.36e-05 ETA=17m 48s elapsed=6m 37s
  [E02 S00290] loss=0.4754 bce=0.3146 dice=0.6361 lr=3.48e-05 ETA=17m 24s elapsed=6m 48s
  [E02 S00300] loss=0.4353 bce=0.2873 dice=0.5833 lr=3.60e-05 ETA=17m 02s elapsed=6m 58s
  [E02 S00310] loss=0.4747 bce=0.2984 dice=0.6509 lr=3.72e-05 ETA=16m 40s elapsed=7m 09s
  [E02 S00320] loss=0.4697 bce=0.2918 dice=0.6477 lr=3.84e-05 ETA=16m 19s elapsed=7m 20s
  [E02 S00330] loss=0.4315 bce=0.2693 dice=0.5937 lr=3.96e-05 ETA=15m 59s elapsed=7m 30s
  [E02 S00340] loss=0.3841 bce=0.2478 dice=0.5205 lr=4.08e-05 ETA=15m 39s elapsed=7m 41s
  [E02 S00350] loss=0.3906 bce=0.2433 dice=0.5379 lr=4.20e-05 ETA=15m 19s elapsed=7m 52s
  [E02 S00360] loss=0.4512 bce=0.2644 dice=0.6380 lr=4.32e-05 ETA=15m 01s elapsed=8m 02s
  [E02 S00370] loss=0.3551 bce=0.2075 dice=0.5026 lr=4.44e-05 ETA=14m 42s elapsed=8m 13s
  [E02 S00380] loss=0.4115 bce=0.2322 dice=0.5908 lr=4.56e-05 ETA=14m 24s elapsed=8m 23s
  [Epoch 02] train_loss=0.4303 val_loss=0.4376 mIoU=0.8006 Dice=0.8820 P=0.8238 R=0.9670 BF1=0.1424 HD=117.9px CE=10.8px
  ★ New best mIoU=0.8006
[Checkpoint] Saved: segmentation_1a_epoch0002_step000387.pt
  [E03 S00390] loss=0.3586 bce=0.2006 dice=0.5166 lr=4.68e-05 ETA=14m 35s elapsed=8m 51s
  [E03 S00400] loss=0.3573 bce=0.1870 dice=0.5276 lr=4.80e-05 ETA=14m 17s elapsed=9m 02s
  [E03 S00410] loss=0.3479 bce=0.1956 dice=0.5002 lr=4.92e-05 ETA=13m 59s elapsed=9m 13s
  [E03 S00420] loss=0.3804 bce=0.2074 dice=0.5534 lr=5.04e-05 ETA=13m 41s elapsed=9m 23s
  [E03 S00430] loss=0.3230 bce=0.1765 dice=0.4694 lr=5.16e-05 ETA=13m 24s elapsed=9m 34s
  [E03 S00440] loss=0.3747 bce=0.1907 dice=0.5587 lr=5.28e-05 ETA=13m 07s elapsed=9m 45s
  [E03 S00450] loss=0.3521 bce=0.1732 dice=0.5310 lr=5.40e-05 ETA=12m 50s elapsed=9m 55s
  [E03 S00460] loss=0.3191 bce=0.1710 dice=0.4672 lr=5.52e-05 ETA=12m 34s elapsed=10m 06s
  [E03 S00470] loss=0.2923 bce=0.1503 dice=0.4343 lr=5.64e-05 ETA=12m 17s elapsed=10m 17s
  [E03 S00480] loss=0.3062 bce=0.1567 dice=0.4557 lr=5.76e-05 ETA=12m 01s elapsed=10m 27s
  [E03 S00490] loss=0.2301 bce=0.1261 dice=0.3340 lr=5.88e-05 ETA=11m 45s elapsed=10m 38s
  [E03 S00500] loss=0.2628 bce=0.1308 dice=0.3949 lr=6.00e-05 ETA=11m 30s elapsed=10m 48s
  [E03 S00510] loss=0.2763 bce=0.1337 dice=0.4190 lr=5.99e-05 ETA=11m 15s elapsed=10m 59s
  [Epoch 03] train_loss=0.3280 val_loss=0.3517 mIoU=0.8980 Dice=0.9434 P=0.9348 R=0.9577 BF1=0.2501 HD=53.9px CE=3.6px
  ★ New best mIoU=0.8980
[Checkpoint] Saved: segmentation_1a_epoch0003_step000516.pt
[Checkpoint] Deleted old: segmentation_1a_epoch0000_step000129.pt
  [E04 S00520] loss=0.2809 bce=0.1325 dice=0.4293 lr=5.98e-05 ETA=11m 17s elapsed=11m 28s
  [E04 S00530] loss=0.2446 bce=0.1125 dice=0.3768 lr=5.95e-05 ETA=11m 01s elapsed=11m 38s
  [E04 S00540] loss=0.3036 bce=0.1302 dice=0.4770 lr=5.92e-05 ETA=10m 46s elapsed=11m 49s
  [E04 S00550] loss=0.2653 bce=0.1145 dice=0.4161 lr=5.87e-05 ETA=10m 31s elapsed=12m 00s
  [E04 S00560] loss=0.2537 bce=0.1134 dice=0.3940 lr=5.81e-05 ETA=10m 15s elapsed=12m 10s
  [E04 S00570] loss=0.3154 bce=0.1454 dice=0.4854 lr=5.75e-05 ETA=10m 00s elapsed=12m 21s
  [E04 S00580] loss=0.2668 bce=0.1117 dice=0.4218 lr=5.67e-05 ETA=9m 45s elapsed=12m 31s
  [E04 S00590] loss=0.2511 bce=0.1067 dice=0.3956 lr=5.59e-05 ETA=9m 31s elapsed=12m 42s
  [E04 S00600] loss=0.2651 bce=0.1126 dice=0.4177 lr=5.49e-05 ETA=9m 16s elapsed=12m 53s
  [E04 S00610] loss=0.2488 bce=0.1063 dice=0.3912 lr=5.39e-05 ETA=9m 02s elapsed=13m 03s
  [E04 S00620] loss=0.2882 bce=0.1079 dice=0.4685 lr=5.28e-05 ETA=8m 47s elapsed=13m 14s
  [E04 S00630] loss=0.2788 bce=0.1059 dice=0.4517 lr=5.16e-05 ETA=8m 33s elapsed=13m 25s
  [E04 S00640] loss=0.2654 bce=0.1123 dice=0.4184 lr=5.03e-05 ETA=8m 19s elapsed=13m 35s
  [Epoch 04] train_loss=0.2544 val_loss=0.2675 mIoU=0.9195 Dice=0.9558 P=0.9621 R=0.9539 BF1=0.3063 HD=26.7px CE=2.2px
  ★ New best mIoU=0.9195
[Checkpoint] Saved: segmentation_1a_epoch0004_step000645.pt
[Checkpoint] Deleted old: segmentation_1a_epoch0001_step000258.pt
  [E05 S00650] loss=0.1974 bce=0.0892 dice=0.3056 lr=4.90e-05 ETA=8m 18s elapsed=14m 07s
  [E05 S00660] loss=0.2205 bce=0.0918 dice=0.3491 lr=4.76e-05 ETA=8m 03s elapsed=14m 18s
  [E05 S00670] loss=0.2516 bce=0.0942 dice=0.4089 lr=4.61e-05 ETA=7m 49s elapsed=14m 29s
  [E05 S00680] loss=0.1897 bce=0.0936 dice=0.2858 lr=4.46e-05 ETA=7m 35s elapsed=14m 39s
  [E05 S00690] loss=0.1810 bce=0.0799 dice=0.2822 lr=4.30e-05 ETA=7m 21s elapsed=14m 50s
  [E05 S00700] loss=0.2161 bce=0.0919 dice=0.3403 lr=4.14e-05 ETA=7m 07s elapsed=15m 01s
  [E05 S00710] loss=0.2468 bce=0.0905 dice=0.4030 lr=3.97e-05 ETA=6m 53s elapsed=15m 11s
  [E05 S00720] loss=0.1781 bce=0.0817 dice=0.2746 lr=3.80e-05 ETA=6m 39s elapsed=15m 22s
  [E05 S00730] loss=0.2467 bce=0.0863 dice=0.4071 lr=3.63e-05 ETA=6m 25s elapsed=15m 32s
  [E05 S00740] loss=0.2153 bce=0.0764 dice=0.3541 lr=3.46e-05 ETA=6m 12s elapsed=15m 43s
  [E05 S00750] loss=0.2012 bce=0.0721 dice=0.3304 lr=3.28e-05 ETA=5m 58s elapsed=15m 54s
  [E05 S00760] loss=0.1768 bce=0.0809 dice=0.2728 lr=3.11e-05 ETA=5m 45s elapsed=16m 04s
  [E05 S00770] loss=0.1971 bce=0.0688 dice=0.3255 lr=2.93e-05 ETA=5m 31s elapsed=16m 15s
  [Epoch 05] train_loss=0.2095 val_loss=0.2220 mIoU=0.9211 Dice=0.9566 P=0.9794 R=0.9393 BF1=0.2931 HD=13.8px CE=1.5px
  ★ New best mIoU=0.9211
[Checkpoint] Saved: segmentation_1a_epoch0005_step000774.pt
[Checkpoint] Deleted old: segmentation_1a_epoch0002_step000387.pt
  [E06 S00780] loss=0.1719 bce=0.0735 dice=0.2704 lr=2.75e-05 ETA=5m 28s elapsed=16m 56s
  [E06 S00790] loss=0.1948 bce=0.0760 dice=0.3137 lr=2.58e-05 ETA=5m 14s elapsed=17m 06s
  [E06 S00800] loss=0.1708 bce=0.0655 dice=0.2761 lr=2.40e-05 ETA=5m 00s elapsed=17m 17s
  [E06 S00810] loss=0.1979 bce=0.0960 dice=0.2999 lr=2.23e-05 ETA=4m 47s elapsed=17m 27s
  [E06 S00820] loss=0.1799 bce=0.0675 dice=0.2924 lr=2.06e-05 ETA=4m 33s elapsed=17m 38s
  [E06 S00830] loss=0.1670 bce=0.0598 dice=0.2742 lr=1.89e-05 ETA=4m 20s elapsed=17m 49s
  [E06 S00840] loss=0.1743 bce=0.0721 dice=0.2765 lr=1.73e-05 ETA=4m 06s elapsed=17m 59s
  [E06 S00850] loss=0.1766 bce=0.0768 dice=0.2764 lr=1.57e-05 ETA=3m 53s elapsed=18m 10s
  [E06 S00860] loss=0.1455 bce=0.0552 dice=0.2358 lr=1.42e-05 ETA=3m 40s elapsed=18m 20s
  [E06 S00870] loss=0.1842 bce=0.0643 dice=0.3041 lr=1.27e-05 ETA=3m 26s elapsed=18m 31s
  [E06 S00880] loss=0.2159 bce=0.0701 dice=0.3617 lr=1.13e-05 ETA=3m 13s elapsed=18m 42s
  [E06 S00890] loss=0.1874 bce=0.0655 dice=0.3093 lr=9.94e-06 ETA=3m 00s elapsed=18m 52s
  [E06 S00900] loss=0.1905 bce=0.0670 dice=0.3140 lr=8.66e-06 ETA=2m 47s elapsed=19m 03s
  [Epoch 06] train_loss=0.1869 val_loss=0.2063 mIoU=0.9258 Dice=0.9594 P=0.9798 R=0.9439 BF1=0.3146 HD=11.0px CE=1.3px
  ★ New best mIoU=0.9258
[Checkpoint] Saved: segmentation_1a_epoch0006_step000903.pt
[Checkpoint] Deleted old: segmentation_1a_epoch0003_step000516.pt
  [E07 S00910] loss=0.1882 bce=0.0631 dice=0.3133 lr=7.45e-06 ETA=2m 38s elapsed=19m 41s
  [E07 S00920] loss=0.2188 bce=0.0791 dice=0.3585 lr=6.33e-06 ETA=2m 25s elapsed=19m 51s
  [E07 S00930] loss=0.1759 bce=0.0730 dice=0.2788 lr=5.28e-06 ETA=2m 11s elapsed=20m 02s
  [E07 S00940] loss=0.1508 bce=0.0714 dice=0.2302 lr=4.32e-06 ETA=1m 58s elapsed=20m 12s
  [E07 S00950] loss=0.2066 bce=0.0738 dice=0.3395 lr=3.45e-06 ETA=1m 45s elapsed=20m 23s
  [E07 S00960] loss=0.1857 bce=0.0623 dice=0.3090 lr=2.67e-06 ETA=1m 32s elapsed=20m 34s
  [E07 S00970] loss=0.1517 bce=0.0597 dice=0.2438 lr=1.99e-06 ETA=1m 19s elapsed=20m 44s
  [E07 S00980] loss=0.2009 bce=0.0693 dice=0.3326 lr=1.40e-06 ETA=1m 06s elapsed=20m 55s
  [E07 S00990] loss=0.1787 bce=0.0680 dice=0.2894 lr=9.18e-07 ETA=0m 53s elapsed=21m 06s
  [E07 S01000] loss=0.1710 bce=0.0592 dice=0.2828 lr=5.34e-07 ETA=0m 40s elapsed=21m 16s
  [E07 S01010] loss=0.1935 bce=0.0617 dice=0.3253 lr=2.53e-07 ETA=0m 28s elapsed=21m 27s
  [E07 S01020] loss=0.2021 bce=0.0788 dice=0.3253 lr=7.53e-08 ETA=0m 15s elapsed=21m 37s
  [E07 S01030] loss=0.2058 bce=0.0648 dice=0.3467 lr=2.09e-09 ETA=0m 02s elapsed=21m 48s
  [Epoch 07] train_loss=0.1804 val_loss=0.2084 mIoU=0.9224 Dice=0.9574 P=0.9812 R=0.9391 BF1=0.2957 HD=8.5px CE=1.4px
[Checkpoint] Saved: segmentation_1a_epoch0007_step001032.pt
[Checkpoint] Deleted old: segmentation_1a_epoch0004_step000645.pt

--- Sub-stage 1b: Full fine-tune ---
Trainable: 24,724,673 / 24,724,673 params
  [E08 S01040] loss=0.1510 bce=0.0650 dice=0.2371 lr=1.60e-07 ETA=0m 05s elapsed=0m 12s
  [E08 S01050] loss=0.2082 bce=0.0690 dice=0.3475 lr=3.60e-07 ETA=0m 10s elapsed=0m 23s
  [E08 S01060] loss=0.1620 bce=0.0545 dice=0.2695 lr=5.60e-07 ETA=0m 15s elapsed=0m 34s
  [E08 S01070] loss=0.1752 bce=0.0669 dice=0.2835 lr=7.60e-07 ETA=0m 20s elapsed=0m 45s
  [E08 S01080] loss=0.2144 bce=0.0698 dice=0.3591 lr=9.60e-07 ETA=0m 24s elapsed=0m 56s
  [E08 S01090] loss=0.1985 bce=0.0620 dice=0.3351 lr=1.16e-06 ETA=0m 28s elapsed=1m 07s
  [E08 S01100] loss=0.1615 bce=0.0655 dice=0.2574 lr=1.36e-06 ETA=0m 31s elapsed=1m 18s
  [E08 S01110] loss=0.1425 bce=0.0529 dice=0.2322 lr=1.56e-06 ETA=0m 35s elapsed=1m 29s
  [E08 S01120] loss=0.1486 bce=0.0650 dice=0.2321 lr=1.76e-06 ETA=0m 38s elapsed=1m 39s
  [E08 S01130] loss=0.1292 bce=0.0457 dice=0.2127 lr=1.96e-06 ETA=0m 41s elapsed=1m 50s
  [E08 S01140] loss=0.1776 bce=0.0568 dice=0.2985 lr=2.16e-06 ETA=0m 43s elapsed=2m 02s
  [E08 S01150] loss=0.1332 bce=0.0477 dice=0.2187 lr=2.36e-06 ETA=0m 46s elapsed=2m 13s
  [E08 S01160] loss=0.1736 bce=0.0603 dice=0.2868 lr=2.56e-06 ETA=0m 48s elapsed=2m 24s
  [Epoch 08] train_loss=0.1710 val_loss=0.1629 mIoU=0.9279 Dice=0.9604 P=0.9781 R=0.9477 BF1=0.3006 HD=5.1px CE=1.1px
  ★ New best mIoU=0.9279
[Checkpoint] Saved: segmentation_1b_epoch0008_step001161.pt
[Checkpoint] Deleted old: segmentation_1a_epoch0005_step000774.pt
  [E09 S01170] loss=0.1853 bce=0.0549 dice=0.3156 lr=2.76e-06 ETA=0m 58s elapsed=3m 01s
  [E09 S01180] loss=0.1630 bce=0.0503 dice=0.2756 lr=2.96e-06 ETA=1m 00s elapsed=3m 12s
  [E09 S01190] loss=0.2053 bce=0.0632 dice=0.3474 lr=3.16e-06 ETA=1m 01s elapsed=3m 23s
  [E09 S01200] loss=0.1482 bce=0.0490 dice=0.2475 lr=3.36e-06 ETA=1m 02s elapsed=3m 34s
  [E09 S01210] loss=0.1325 bce=0.0579 dice=0.2072 lr=3.56e-06 ETA=1m 03s elapsed=3m 45s
  [E09 S01220] loss=0.1499 bce=0.0566 dice=0.2431 lr=3.76e-06 ETA=1m 03s elapsed=3m 56s
  [E09 S01230] loss=0.1470 bce=0.0512 dice=0.2428 lr=3.96e-06 ETA=1m 04s elapsed=4m 07s
  [E09 S01240] loss=0.1768 bce=0.0532 dice=0.3003 lr=4.16e-06 ETA=1m 04s elapsed=4m 18s
  [E09 S01250] loss=0.1613 bce=0.0466 dice=0.2761 lr=4.36e-06 ETA=1m 04s elapsed=4m 29s
  [E09 S01260] loss=0.1547 bce=0.0502 dice=0.2592 lr=4.56e-06 ETA=1m 04s elapsed=4m 40s
  [E09 S01270] loss=0.1257 bce=0.0427 dice=0.2086 lr=4.76e-06 ETA=1m 03s elapsed=4m 51s
  [E09 S01280] loss=0.1567 bce=0.0499 dice=0.2635 lr=4.96e-06 ETA=1m 03s elapsed=5m 02s
  [E09 S01290] loss=0.1480 bce=0.0466 dice=0.2494 lr=5.16e-06 ETA=1m 02s elapsed=5m 13s
  [Epoch 09] train_loss=0.1497 val_loss=0.1340 mIoU=0.9306 Dice=0.9621 P=0.9722 R=0.9559 BF1=0.3075 HD=4.5px CE=1.1px
  ★ New best mIoU=0.9306
[Checkpoint] Saved: segmentation_1b_epoch0009_step001290.pt
[Checkpoint] Deleted old: segmentation_1a_epoch0006_step000903.pt
  [E10 S01300] loss=0.1138 bce=0.0390 dice=0.1886 lr=5.36e-06 ETA=1m 07s elapsed=5m 52s
  [E10 S01310] loss=0.1216 bce=0.0501 dice=0.1930 lr=5.56e-06 ETA=1m 05s elapsed=6m 03s
  [E10 S01320] loss=0.1495 bce=0.0441 dice=0.2548 lr=5.76e-06 ETA=1m 04s elapsed=6m 14s
  [E10 S01330] loss=0.1574 bce=0.0476 dice=0.2671 lr=5.96e-06 ETA=1m 03s elapsed=6m 25s
  [E10 S01340] loss=0.1393 bce=0.0375 dice=0.2412 lr=6.16e-06 ETA=1m 01s elapsed=6m 35s
  [E10 S01350] loss=0.1323 bce=0.0379 dice=0.2267 lr=6.36e-06 ETA=0m 59s elapsed=6m 46s
  [E10 S01360] loss=0.1287 bce=0.0403 dice=0.2170 lr=6.56e-06 ETA=0m 57s elapsed=6m 57s
  [E10 S01370] loss=0.1460 bce=0.0460 dice=0.2460 lr=6.76e-06 ETA=0m 55s elapsed=7m 08s
  [E10 S01380] loss=0.1242 bce=0.0429 dice=0.2055 lr=6.96e-06 ETA=0m 53s elapsed=7m 19s
  [E10 S01390] loss=0.1234 bce=0.0391 dice=0.2077 lr=7.16e-06 ETA=0m 51s elapsed=7m 30s
  [E10 S01400] loss=0.1495 bce=0.0424 dice=0.2567 lr=7.36e-06 ETA=0m 48s elapsed=7m 41s
  [E10 S01410] loss=0.0830 bce=0.0347 dice=0.1314 lr=7.56e-06 ETA=0m 46s elapsed=7m 52s
  [Epoch 10] train_loss=0.1305 val_loss=0.1124 mIoU=0.9430 Dice=0.9698 P=0.9643 R=0.9770 BF1=0.3671 HD=3.7px CE=0.7px
  ★ New best mIoU=0.9430
[Checkpoint] Saved: segmentation_1b_epoch0010_step001419.pt
[Checkpoint] Deleted old: segmentation_1a_epoch0007_step001032.pt
  [E11 S01420] loss=0.1124 bce=0.0388 dice=0.1861 lr=7.76e-06 ETA=0m 46s elapsed=8m 40s
  [E11 S01430] loss=0.1126 bce=0.0372 dice=0.1880 lr=7.96e-06 ETA=0m 43s elapsed=8m 51s
  [E11 S01440] loss=0.1211 bce=0.0399 dice=0.2024 lr=8.16e-06 ETA=0m 40s elapsed=9m 02s
  [E11 S01450] loss=0.1169 bce=0.0330 dice=0.2008 lr=8.36e-06 ETA=0m 37s elapsed=9m 13s
  [E11 S01460] loss=0.1403 bce=0.0370 dice=0.2436 lr=8.56e-06 ETA=0m 34s elapsed=9m 24s
  [E11 S01470] loss=0.1182 bce=0.0363 dice=0.2000 lr=8.76e-06 ETA=0m 30s elapsed=9m 35s
  [E11 S01480] loss=0.0876 bce=0.0329 dice=0.1422 lr=8.96e-06 ETA=0m 26s elapsed=9m 46s
  [E11 S01490] loss=0.0939 bce=0.0317 dice=0.1561 lr=9.16e-06 ETA=0m 23s elapsed=9m 57s
  [E11 S01500] loss=0.1318 bce=0.0350 dice=0.2285 lr=9.36e-06 ETA=0m 19s elapsed=10m 08s
  [E11 S01510] loss=0.1042 bce=0.0313 dice=0.1770 lr=9.56e-06 ETA=0m 15s elapsed=10m 19s
  [E11 S01520] loss=0.1127 bce=0.0362 dice=0.1893 lr=9.76e-06 ETA=0m 11s elapsed=10m 30s
  [E11 S01530] loss=0.1081 bce=0.0400 dice=0.1762 lr=9.96e-06 ETA=0m 07s elapsed=10m 41s
  [E11 S01540] loss=0.1030 bce=0.0396 dice=0.1664 lr=1.00e-05 ETA=0m 03s elapsed=10m 52s
  [Epoch 11] train_loss=0.1168 val_loss=0.0986 mIoU=0.9471 Dice=0.9721 P=0.9761 R=0.9694 BF1=0.4032 HD=3.6px CE=0.7px
  ★ New best mIoU=0.9471
[Checkpoint] Saved: segmentation_1b_epoch0011_step001548.pt
[Checkpoint] Deleted old: segmentation_1b_epoch0008_step001161.pt
  [E12 S01550] loss=0.0902 bce=0.0319 dice=0.1485 lr=9.99e-06 ETA=59m 59s elapsed=11m 40s
  [E12 S01560] loss=0.1023 bce=0.0316 dice=0.1730 lr=9.98e-06 ETA=59m 54s elapsed=11m 51s
  [E12 S01570] loss=0.0979 bce=0.0341 dice=0.1618 lr=9.97e-06 ETA=59m 49s elapsed=12m 02s
  [E12 S01580] loss=0.1084 bce=0.0331 dice=0.1837 lr=9.95e-06 ETA=59m 45s elapsed=12m 13s
  [E12 S01590] loss=0.1122 bce=0.0333 dice=0.1911 lr=9.92e-06 ETA=59m 40s elapsed=12m 24s
  [E12 S01600] loss=0.1023 bce=0.0335 dice=0.1711 lr=9.90e-06 ETA=59m 35s elapsed=12m 35s
  [E12 S01610] loss=0.1162 bce=0.0364 dice=0.1959 lr=9.86e-06 ETA=59m 30s elapsed=12m 46s
  [E12 S01620] loss=0.1131 bce=0.0333 dice=0.1929 lr=9.83e-06 ETA=59m 25s elapsed=12m 57s
  [E12 S01630] loss=0.1008 bce=0.0315 dice=0.1701 lr=9.79e-06 ETA=59m 20s elapsed=13m 08s
  [E12 S01640] loss=0.1094 bce=0.0325 dice=0.1863 lr=9.74e-06 ETA=59m 15s elapsed=13m 19s
  [E12 S01650] loss=0.1104 bce=0.0338 dice=0.1871 lr=9.69e-06 ETA=59m 09s elapsed=13m 30s
  [E12 S01660] loss=0.0900 bce=0.0285 dice=0.1515 lr=9.64e-06 ETA=59m 04s elapsed=13m 41s
  [E12 S01670] loss=0.0971 bce=0.0329 dice=0.1614 lr=9.58e-06 ETA=58m 59s elapsed=13m 52s
  [Epoch 12] train_loss=0.1023 val_loss=0.0951 mIoU=0.9437 Dice=0.9705 P=0.9580 R=0.9844 BF1=0.3586 HD=3.7px CE=0.7px
  [E13 S01680] loss=0.0812 bce=0.0283 dice=0.1341 lr=9.52e-06 ETA=58m 50s elapsed=14m 49s
  [E13 S01690] loss=0.0909 bce=0.0288 dice=0.1530 lr=9.45e-06 ETA=58m 44s elapsed=15m 00s
  [E13 S01700] loss=0.1118 bce=0.0307 dice=0.1928 lr=9.38e-06 ETA=58m 38s elapsed=15m 11s
  [E13 S01710] loss=0.0908 bce=0.0266 dice=0.1550 lr=9.30e-06 ETA=58m 32s elapsed=15m 22s
  [E13 S01720] loss=0.0843 bce=0.0299 dice=0.1387 lr=9.23e-06 ETA=58m 26s elapsed=15m 33s
  [E13 S01730] loss=0.0771 bce=0.0292 dice=0.1250 lr=9.14e-06 ETA=58m 20s elapsed=15m 44s
  [E13 S01740] loss=0.1049 bce=0.0293 dice=0.1805 lr=9.06e-06 ETA=58m 14s elapsed=15m 55s
  [E13 S01750] loss=0.1015 bce=0.0279 dice=0.1751 lr=8.97e-06 ETA=58m 08s elapsed=16m 06s
  [E13 S01760] loss=0.1126 bce=0.0312 dice=0.1940 lr=8.88e-06 ETA=58m 02s elapsed=16m 17s
  [E13 S01770] loss=0.0853 bce=0.0281 dice=0.1425 lr=8.78e-06 ETA=57m 56s elapsed=16m 28s
  [E13 S01780] loss=0.0841 bce=0.0251 dice=0.1431 lr=8.68e-06 ETA=57m 49s elapsed=16m 39s
  [E13 S01790] loss=0.0793 bce=0.0266 dice=0.1319 lr=8.58e-06 ETA=57m 43s elapsed=16m 50s
  [E13 S01800] loss=0.0922 bce=0.0258 dice=0.1585 lr=8.47e-06 ETA=57m 37s elapsed=17m 01s
  [Epoch 13] train_loss=0.0919 val_loss=0.0866 mIoU=0.9510 Dice=0.9743 P=0.9702 R=0.9793 BF1=0.4261 HD=3.3px CE=0.7px
  ★ New best mIoU=0.9510
[Checkpoint] Saved: segmentation_1b_epoch0013_step001806.pt
[Checkpoint] Deleted old: segmentation_1b_epoch0009_step001290.pt
  [E14 S01810] loss=0.0766 bce=0.0280 dice=0.1253 lr=8.36e-06 ETA=57m 24s elapsed=17m 54s
  [E14 S01820] loss=0.0902 bce=0.0291 dice=0.1512 lr=8.25e-06 ETA=57m 17s elapsed=18m 05s
  [E14 S01830] loss=0.0672 bce=0.0262 dice=0.1081 lr=8.13e-06 ETA=57m 11s elapsed=18m 16s
  [E14 S01840] loss=0.0826 bce=0.0263 dice=0.1388 lr=8.02e-06 ETA=57m 04s elapsed=18m 27s
  [E14 S01850] loss=0.0814 bce=0.0249 dice=0.1380 lr=7.90e-06 ETA=56m 57s elapsed=18m 38s
  [E14 S01860] loss=0.0731 bce=0.0258 dice=0.1204 lr=7.77e-06 ETA=56m 50s elapsed=18m 49s
  [E14 S01870] loss=0.0871 bce=0.0276 dice=0.1467 lr=7.65e-06 ETA=56m 43s elapsed=19m 00s
  [E14 S01880] loss=0.0605 bce=0.0241 dice=0.0970 lr=7.52e-06 ETA=56m 36s elapsed=19m 11s
  [E14 S01890] loss=0.0999 bce=0.0286 dice=0.1711 lr=7.39e-06 ETA=56m 29s elapsed=19m 22s
  [E14 S01900] loss=0.0989 bce=0.0294 dice=0.1684 lr=7.25e-06 ETA=56m 22s elapsed=19m 33s
  [E14 S01910] loss=0.0812 bce=0.0248 dice=0.1375 lr=7.12e-06 ETA=56m 15s elapsed=19m 44s
  [E14 S01920] loss=0.0778 bce=0.0236 dice=0.1321 lr=6.98e-06 ETA=56m 08s elapsed=19m 55s
  [E14 S01930] loss=0.0883 bce=0.0255 dice=0.1510 lr=6.84e-06 ETA=56m 01s elapsed=20m 05s
  [Epoch 14] train_loss=0.0855 val_loss=0.0876 mIoU=0.9488 Dice=0.9731 P=0.9666 R=0.9810 BF1=0.4083 HD=3.4px CE=0.7px
  [E15 S01940] loss=0.0790 bce=0.0246 dice=0.1333 lr=6.70e-06 ETA=55m 44s elapsed=21m 02s
  [E15 S01950] loss=0.0589 bce=0.0248 dice=0.0929 lr=6.56e-06 ETA=55m 37s elapsed=21m 13s
  [E15 S01960] loss=0.0909 bce=0.0281 dice=0.1536 lr=6.42e-06 ETA=55m 29s elapsed=21m 24s
  [E15 S01970] loss=0.0669 bce=0.0240 dice=0.1098 lr=6.27e-06 ETA=55m 22s elapsed=21m 35s
  [E15 S01980] loss=0.0834 bce=0.0263 dice=0.1405 lr=6.13e-06 ETA=55m 14s elapsed=21m 46s
  [E15 S01990] loss=0.0821 bce=0.0261 dice=0.1381 lr=5.98e-06 ETA=55m 07s elapsed=21m 57s
  [E15 S02000] loss=0.0710 bce=0.0246 dice=0.1174 lr=5.84e-06 ETA=54m 59s elapsed=22m 08s
  [E15 S02010] loss=0.0753 bce=0.0254 dice=0.1253 lr=5.69e-06 ETA=54m 52s elapsed=22m 19s
  [E15 S02020] loss=0.1171 bce=0.0319 dice=0.2023 lr=5.54e-06 ETA=54m 44s elapsed=22m 30s
  [E15 S02030] loss=0.0773 bce=0.0249 dice=0.1298 lr=5.39e-06 ETA=54m 36s elapsed=22m 41s
  [E15 S02040] loss=0.0715 bce=0.0239 dice=0.1192 lr=5.24e-06 ETA=54m 28s elapsed=22m 52s
  [E15 S02050] loss=0.0570 bce=0.0220 dice=0.0920 lr=5.09e-06 ETA=54m 21s elapsed=23m 03s
  [E15 S02060] loss=0.0738 bce=0.0237 dice=0.1239 lr=4.94e-06 ETA=54m 13s elapsed=23m 14s
  [Epoch 15] train_loss=0.0800 val_loss=0.0811 mIoU=0.9453 Dice=0.9710 P=0.9636 R=0.9803 BF1=0.4037 HD=3.7px CE=0.8px
  [E16 S02070] loss=0.0846 bce=0.0256 dice=0.1436 lr=4.79e-06 ETA=53m 54s elapsed=24m 11s
  [E16 S02080] loss=0.0888 bce=0.0236 dice=0.1540 lr=4.64e-06 ETA=53m 46s elapsed=24m 22s
  [E16 S02090] loss=0.0714 bce=0.0263 dice=0.1165 lr=4.49e-06 ETA=53m 37s elapsed=24m 33s
  [E16 S02100] loss=0.0848 bce=0.0256 dice=0.1440 lr=4.34e-06 ETA=53m 29s elapsed=24m 44s
  [E16 S02110] loss=0.0493 bce=0.0213 dice=0.0772 lr=4.19e-06 ETA=53m 21s elapsed=24m 55s
  [E16 S02120] loss=0.0672 bce=0.0238 dice=0.1106 lr=4.05e-06 ETA=53m 13s elapsed=25m 06s
  [E16 S02130] loss=0.0702 bce=0.0233 dice=0.1170 lr=3.90e-06 ETA=53m 05s elapsed=25m 17s
  [E16 S02140] loss=0.0724 bce=0.0248 dice=0.1199 lr=3.75e-06 ETA=52m 57s elapsed=25m 27s
  [E16 S02150] loss=0.0647 bce=0.0217 dice=0.1077 lr=3.61e-06 ETA=52m 49s elapsed=25m 38s
  [E16 S02160] loss=0.0815 bce=0.0268 dice=0.1363 lr=3.47e-06 ETA=52m 40s elapsed=25m 49s
  [E16 S02170] loss=0.0608 bce=0.0228 dice=0.0989 lr=3.32e-06 ETA=52m 32s elapsed=26m 00s
  [E16 S02180] loss=0.0967 bce=0.0285 dice=0.1649 lr=3.18e-06 ETA=52m 24s elapsed=26m 11s
  [E16 S02190] loss=0.0672 bce=0.0235 dice=0.1109 lr=3.05e-06 ETA=52m 15s elapsed=26m 22s
  [Epoch 16] train_loss=0.0767 val_loss=0.0771 mIoU=0.9473 Dice=0.9721 P=0.9665 R=0.9795 BF1=0.4244 HD=3.6px CE=0.8px
  [E17 S02200] loss=0.0672 bce=0.0227 dice=0.1118 lr=2.91e-06 ETA=51m 54s elapsed=27m 18s
  [E17 S02210] loss=0.0942 bce=0.0259 dice=0.1625 lr=2.77e-06 ETA=51m 45s elapsed=27m 29s
  [E17 S02220] loss=0.0918 bce=0.0281 dice=0.1555 lr=2.64e-06 ETA=51m 37s elapsed=27m 40s
  [E17 S02230] loss=0.0695 bce=0.0262 dice=0.1127 lr=2.51e-06 ETA=51m 28s elapsed=27m 51s
  [E17 S02240] loss=0.0741 bce=0.0258 dice=0.1223 lr=2.38e-06 ETA=51m 20s elapsed=28m 02s
  [E17 S02250] loss=0.1063 bce=0.0277 dice=0.1849 lr=2.25e-06 ETA=51m 11s elapsed=28m 13s
  [E17 S02260] loss=0.0933 bce=0.0265 dice=0.1601 lr=2.13e-06 ETA=51m 02s elapsed=28m 24s
  [E17 S02270] loss=0.0873 bce=0.0260 dice=0.1485 lr=2.01e-06 ETA=50m 54s elapsed=28m 35s
  [E17 S02280] loss=0.0734 bce=0.0244 dice=0.1225 lr=1.89e-06 ETA=50m 45s elapsed=28m 46s
  [E17 S02290] loss=0.0822 bce=0.0250 dice=0.1394 lr=1.77e-06 ETA=50m 36s elapsed=28m 57s
  [E17 S02300] loss=0.0710 bce=0.0238 dice=0.1181 lr=1.66e-06 ETA=50m 28s elapsed=29m 08s
  [E17 S02310] loss=0.0773 bce=0.0237 dice=0.1309 lr=1.55e-06 ETA=50m 19s elapsed=29m 19s
  [E17 S02320] loss=0.1272 bce=0.0295 dice=0.2249 lr=1.44e-06 ETA=50m 10s elapsed=29m 30s
  [Epoch 17] train_loss=0.0758 val_loss=0.0819 mIoU=0.9434 Dice=0.9699 P=0.9635 R=0.9786 BF1=0.3953 HD=3.7px CE=0.9px
