/home/siu856569517/Taminul/co2_farm/src/train/train_ddpm.py:83: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
/home/siu856569517/.conda/envs/rumiformer/lib/python3.9/site-packages/wandb/sdk/launch/builder/build.py:11: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/home/siu856569517/.conda/envs/rumiformer/lib/python3.9/site-packages/wandb/sdk/launch/builder/build.py:11: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
wandb: Currently logged in as: taminul. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.25.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in /home/siu856569517/Taminul/co2_farm/wandb/run-20260228_095411-kcs57evx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ddpm
wandb: ‚≠êÔ∏è View project at https://wandb.ai/taminul/rumiformer
wandb: üöÄ View run at https://wandb.ai/taminul/rumiformer/runs/kcs57evx
============================================================
  RumiFormer ‚Äî Stage 6: DDPM Augmentation
============================================================
  project_root: /home/siu856569517/Taminul/co2_farm
  annotations_csv: /home/siu856569517/Taminul/co2_farm/annotations/annotations.csv
  clips_csv: /home/siu856569517/Taminul/co2_farm/annotations/clips.csv
  checkpoint_dir: /home/siu856569517/Taminul/co2_farm/outputs/checkpoints
  log_dir: /home/siu856569517/Taminul/co2_farm/outputs/logs
  seed: 42
  precision: bf16
  num_workers: 8
  pin_memory: True
  use_compile: True
  gradient_checkpointing: False
  optimizer: adamw
  weight_decay: 0.01
  resume_from: None
  save_every_n_epochs: 1
  save_every_n_steps: None
  keep_last_n_checkpoints: 3
  use_wandb: True
  wandb_project: rumiformer
  wandb_run_name: None
  log_every_n_steps: 10
  show_eta: True
  stage_name: ddpm
  epochs: 80
  lr: 0.0001
  batch_size: 64
  base_channels: 64
  diffusion_steps: 100
  train_resolution: (48, 64)
  n_synthetic_masks: 200
  target_class: 0
============================================================
World size: 1 GPUs
DDPM U-Net params: 6,669,377
Train: 3734 masks
/home/siu856569517/Taminul/co2_farm/src/train/train_ddpm.py:129: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(dtype=torch.bfloat16):
Traceback (most recent call last):
  File "/home/siu856569517/Taminul/co2_farm/src/train/train_ddpm.py", line 188, in <module>
    main()
  File "/home/siu856569517/Taminul/co2_farm/src/train/train_ddpm.py", line 130, in main
    x_t, noise = q_sample(masks, t, diffusion_params)
  File "/home/siu856569517/Taminul/co2_farm/src/data/ddpm_augment.py", line 211, in q_sample
    sqrt_alpha = diffusion_params["sqrt_alphas_cumprod"][t][:, None, None, None]
RuntimeError: indices should be either on cpu or on the same device as the indexed tensor (cpu)
Traceback (most recent call last):
  File "/home/siu856569517/Taminul/co2_farm/src/train/train_ddpm.py", line 188, in <module>
    main()
  File "/home/siu856569517/Taminul/co2_farm/src/train/train_ddpm.py", line 130, in main
    x_t, noise = q_sample(masks, t, diffusion_params)
  File "/home/siu856569517/Taminul/co2_farm/src/data/ddpm_augment.py", line 211, in q_sample
    sqrt_alpha = diffusion_params["sqrt_alphas_cumprod"][t][:, None, None, None]
RuntimeError: indices should be either on cpu or on the same device as the indexed tensor (cpu)
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: / 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: üöÄ View run ddpm at: https://wandb.ai/taminul/rumiformer/runs/kcs57evx
wandb: Ô∏è‚ö° View job at https://wandb.ai/taminul/rumiformer/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjkxMzY4ODQzMg==/version_details/v0
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20260228_095411-kcs57evx/logs
